{% extends "base.html" %}

{% block title %}Home{% endblock %}


{% block content %}

<div class="thing-at-top-of-main">

  {% if user.is_authenticated %}
    Welcome, {{ user.username }}!
    <a href="{% url 'logout' %}"> Log Out</a>
  {% else %}
    <p>You are not logged in</p>
    <a href="{% url 'login' %}">Log In</a><br>
    <a href="{% url 'signup' %}">Sign Up</a>
  {% endif %}

</div>

<h2>The List of Links</h2>
<div id="app" class="all-the-taps">
  
  <template v-if="Object.keys(taps).length">
    <article v-for="tap in taps" class="a-tap-in-the-list">
      <h3>[[ tap.title ]]</h3>
      <button
        @click="loadSingleTap(tap)"
      >
        View details for this Item
      </button>
      <br>
      <a
        :href="tap.url"
        v-bind:title="tap.url_label"
        target="_blank"
      >
        [[ tap.url_label ]]
      </a>
      <br>
      <p>[[ tap.id ]] : [[ tap.description ]]</p>
      <a
        :href="tap.localBrowsableApiUrl"
        v-bind:title="tap.localBrowsableApiUrlDescription"
        target="_blank"
      >
        [[ tap.localBrowsableApiUrlDescription ]]
      </a>
    </article>
  </template>

  <template v-if="Object.keys(currentTap).length">
    <article :model="currentTap" class="a-current-tap">
      <h3>[[ currentTap.title ]]</h3>
      <a
        :href="currentTap.url"
        v-bind:title="currentTap.url_label"
        target="_blank"
      >
        [[ currentTap.url_label ]]
      </a>
      <br>
      <p>[[ currentTap.id ]] : [[ currentTap.description ]]</p>
      <a
        :href="currentTap.localBrowsableApiUrl"
        v-bind:title="currentTap.localBrowsableApiUrlDescription"
        target="_blank"
      >
        [[ currentTap.localBrowsableApiUrlDescription ]]
      </a>
      <br>
      <button @click="editTap()">Edit this Item</button>
    </article>
  </template>

  <template v-if="Object.keys(editingCurrentTap).length">
    <article class="an-editing-tap">
      <h3>[[ temporaryTapTitle ]]</h3>
      <!-- <h3>[[ editingCurrentTap.title ]]</h3>This will be removed in production. Used here for debugging. -->

      <br>
      <button @click="editTitle = !editTitle">[[ editTitle ? "Done editing Title" : "Edit Title" ]]</button>
      <br>
      <template v-if="editTitle">
        <input v-model="editingCurrentTap.title" type="text" size="75">
      </template>
      <template v-else>
        <span>[[ editingCurrentTap.title ]]</span>
      </template>
      <br>

      <br>
      <button @click="editUrlLabel = !editUrlLabel">[[ editUrlLabel ? "Done editing URL Label" : "Edit URL Label" ]]</button>
      <br>
      <template v-if="editUrlLabel">
        <textarea v-model="editingCurrentTap.url_label" rows="6" cols="75"></textarea>
      </template>
      <template v-else>
        <span>[[ editingCurrentTap.url_label ]]</span>
      </template>
      <br>


      <br>
      <button @click="editDescription = !editDescription">[[ editDescription ? "Done editing Description" : "Edit Description" ]]</button>
      <br>
      <template v-if="editDescription">
        <textarea v-model="editingCurrentTap.description" rows="6" cols="75"></textarea>
      </template>
      <template v-else>
        <span>[[ editingCurrentTap.description ]]</span>
      </template>
      <br>

      <br>
      <button @click="saveTap()">Save Changes to Item</button>
      <button @click="loadSingleTap(editingCurrentTap)">Exit without saving changes</button>
    </article>
  </template>

</div>



{% endblock %}